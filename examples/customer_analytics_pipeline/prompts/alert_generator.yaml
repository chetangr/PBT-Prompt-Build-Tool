name: alert_generator
version: 2.1.0
description: Generates alerts based on sentiment and emotion analysis
depends_on:
  - ref('sentiment_analyzer')
  - ref('emotion_classifier')
variables:
  - sentiment_data
  - emotion_data
  - alert_thresholds
  - alert_channels
template: |
  Generate alerts based on analysis:
  
  Sentiment Data: {{ sentiment_data }}
  Emotion Data: {{ emotion_data }}
  Alert Thresholds: {{ alert_thresholds }}
  Target Channels: {{ alert_channels }}
  
  Check for alert conditions:
  1. High negative sentiment concentration (>threshold)
  2. Strong negative emotions (anger > 7, frustration > 8)
  3. Sentiment decline patterns
  4. Critical issues mentioned (data loss, security, etc.)
  5. VIP customer negative feedback
  
  For each alert:
  - Set priority (P1: critical, P2: high, P3: medium)
  - Determine routing (support, product, executive)
  - Create actionable summary
  - Suggest immediate actions
  
  Return structured alerts ready for dispatch.
model_config:
  temperature: 0.2
  max_tokens: 1500
examples:
  - input:
      sentiment_data: '[{"sentiment": "negative", "confidence": 0.95, "intensity": 5}]'
      emotion_data: '[{"primary_emotion": "anger", "emotional_intensity": 9}]'
      alert_thresholds: {"negative_threshold": 0.8, "emotion_intensity": 7}
      alert_channels: ["slack", "email"]
    output: |
      {
        "alerts": [
          {
            "id": "ALT_001",
            "priority": "P1",
            "type": "customer_crisis",
            "summary": "Critical: High anger detected in customer feedback",
            "details": {
              "sentiment_score": -0.95,
              "emotion_intensity": 9,
              "affected_customers": 1
            },
            "routing": ["support_manager", "product_team"],
            "channels": ["slack", "email"],
            "recommended_actions": [
              "Immediate customer outreach",
              "Escalate to senior support",
              "Root cause analysis"
            ],
            "created_at": "2024-01-15T14:30:00Z"
          }
        ]
      }
tags:
  - alerting
  - monitoring
  - customer-experience
config:
  materialized: table
  real_time: true