name: insight_compiler
version: 3.0.0
description: Compiles insights from alerts and trends into actionable intelligence
depends_on:
  - ref('alert_generator')
  - ref('trend_analyzer')
variables:
  - alerts_data
  - trends_data
  - business_context
  - insight_depth
template: |
  Compile comprehensive insights from analysis:
  
  Alerts: {{ alerts_data }}
  Trends: {{ trends_data }}
  Business Context: {{ business_context }}
  Insight Depth: {{ insight_depth }}
  
  Generate insights covering:
  
  1. IMMEDIATE CONCERNS
     - Active alerts and their business impact
     - Customer segments most affected
     - Revenue/retention risk assessment
  
  2. TREND INSIGHTS
     - Emerging patterns requiring attention
     - Improving vs declining areas
     - Predictive indicators
  
  3. ROOT CAUSE ANALYSIS
     - Common factors in negative feedback
     - Correlation between issues
     - System/process failures
  
  4. OPPORTUNITIES
     - Quick wins from feedback
     - Feature requests with high impact
     - Positive trends to amplify
  
  5. STRATEGIC RECOMMENDATIONS
     - Short-term actions (next 7 days)
     - Medium-term initiatives (next month)
     - Long-term strategic considerations
  
  Structure insights for executive consumption.
model_config:
  temperature: 0.5
  max_tokens: 3000
examples:
  - input:
      alerts_data: '{"alerts": [{"priority": "P1", "type": "performance_degradation"}]}'
      trends_data: '{"trends": [{"topic": "slow_loading", "trend_direction": "rising"}]}'
      business_context: "Q4 revenue targets, new feature launch"
      insight_depth: "executive"
    output: |
      {
        "executive_insights": {
          "critical_issues": [
            {
              "issue": "Performance Crisis Emerging",
              "impact": "73% increase in performance complaints",
              "revenue_at_risk": "$450K monthly recurring",
              "affected_segments": ["enterprise", "power_users"],
              "root_cause": "Recent deployment scaling issues"
            }
          ],
          "key_trends": [
            {
              "trend": "Rising Technical Complaints",
              "trajectory": "+73% week-over-week",
              "projected_impact": "15% churn risk if unaddressed",
              "correlation": "Coincides with v2.5 release"
            }
          ],
          "opportunities": [
            {
              "opportunity": "Performance optimization",
              "potential_impact": "Reduce churn by 10%",
              "effort": "2 sprint cycles",
              "roi": "5x in prevented churn"
            }
          ],
          "recommendations": {
            "immediate": [
              "Roll back v2.5 to stable v2.4",
              "Deploy performance hotfix",
              "Proactive outreach to affected enterprise accounts"
            ],
            "short_term": [
              "Implement performance monitoring",
              "Create customer communication plan",
              "Establish performance SLAs"
            ],
            "strategic": [
              "Invest in infrastructure scaling",
              "Implement staged rollout process",
              "Create early warning system"
            ]
          }
        }
      }
tags:
  - insights
  - analytics
  - executive-reporting
config:
  materialized: table
  schedule: "0 8 * * *"  # Daily at 8 AM